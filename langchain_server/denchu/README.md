# Denchu Interactive Server

é›»æŸ±ãƒã‚§ãƒƒã‚¯æ¥­å‹™å‘ã‘ã®å¯¾è©±å‹LangChainã‚µãƒ¼ãƒãƒ¼ã§ã™ã€‚OpenWebUIã¨é€£æºã—ã€MCPã‚µãƒ¼ãƒãƒ¼ã‚’é€šã˜ã¦å®Ÿéš›ã®æ¥­å‹™ãƒ„ãƒ¼ãƒ«ã¨çµ±åˆã•ã‚ŒãŸã€å®Ÿç”¨çš„ãªAIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚

## ğŸ¯ ç›®çš„

- **å®Ÿæ¥­å‹™å¯¾å¿œ**: é›»æŸ±ä¿å®ˆãƒ»ç‚¹æ¤œæ¥­å‹™ã®åŠ¹ç‡åŒ–
- **å¯¾è©±å‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹**: OpenWebUIã«ã‚ˆã‚‹ç›´æ„Ÿçš„ãªæ“ä½œ
- **ãƒ„ãƒ¼ãƒ«çµ±åˆ**: MCPã‚µãƒ¼ãƒãƒ¼çµŒç”±ã§ã®å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æº
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®å‹•çš„ãªå¯¾è©±ã«å¯¾å¿œ

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
OpenWebUI â†’ FastAPI â†’ LangChain Agent â†’ MCP Server â†’ Business Tools
   â†“           â†“           â†“              â†“           â†“
 Web UI  â†’ REST API â†’ ReAct Agent â†’ Java Tools â†’ Checklist DB
```

## âœ¨ ä¸»è¦æ©Ÿèƒ½

### ğŸ¤– AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ©Ÿèƒ½
- âœ… **ReAct Pattern**: æ¨è«–-è¡Œå‹•-è¦³å¯Ÿã‚µã‚¤ã‚¯ãƒ«ã«ã‚ˆã‚‹å‹•çš„å‡¦ç†
- âœ… **ãƒãƒ«ãƒãƒ„ãƒ¼ãƒ«**: è¤‡æ•°ã®MCPã‚µãƒ¼ãƒãƒ¼ã¨ã®ä¸¦è¡Œé€£æº
- âœ… **çŠ¶æ³åˆ¤æ–­**: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«å¿œã˜ãŸé©åˆ‡ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³é¸æŠ
- âœ… **ã‚¨ãƒ©ãƒ¼å¾©æ—§**: å¤±æ•—æ™‚ã®è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤ã¨ä»£æ›¿æ‰‹æ®µ

### ğŸ“‹ é›»æŸ±ãƒã‚§ãƒƒã‚¯æ¥­å‹™
- âœ… **ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆç®¡ç†**: é …ç›®åˆ¥ã®OK/NGåˆ¤å®š
- âœ… **é€²æ—è¿½è·¡**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã®ä½œæ¥­çŠ¶æ³ç¢ºèª
- âœ… **ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ**: Excelå½¢å¼ã§ã®çµæœå‡ºåŠ›
- âœ… **å‚™è€ƒç®¡ç†**: è©³ç´°æƒ…å ±ã®è¨˜éŒ²ã¨å‚ç…§

### ğŸŒ Web API
- âœ… **OpenAIäº’æ›**: `/v1/chat/completions` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- âœ… **ãƒ¢ãƒ‡ãƒ«æƒ…å ±**: `/v1/models` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- âœ… **éåŒæœŸå‡¦ç†**: é«˜æ€§èƒ½ãªä¸¦è¡Œãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†
- âœ… **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: å …ç‰¢ãªã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨é©åˆ‡ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. å‰ææ¡ä»¶

```bash
# LLMã‚¨ãƒ³ã‚¸ãƒ³ã®èµ·å‹•
ollama serve
ollama pull qwen3:14b

# Javaç’°å¢ƒã®ç¢ºèªï¼ˆMCPã‚µãƒ¼ãƒãƒ¼ç”¨ï¼‰
java --version
```

### 2. ã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
# åŸºæœ¬èµ·å‹•
cd langchain_server/denchu
python app.py

# ã‚«ã‚¹ã‚¿ãƒ è¨­å®šã§èµ·å‹•
python app.py custom_config.json
```

### 3. OpenWebUIã¨ã®é€£æº

```bash
# OpenWebUIã®èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰
cd openwebui-docker
docker-compose up -d

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹
open http://localhost:3000
```

### 4. APIè¨­å®š

OpenWebUIã®è¨­å®šç”»é¢ã§ï¼š
- **API Base URL**: `http://localhost:8000`
- **API Key**: `EMPTY`ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼‰

## âš™ï¸ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

### app.json ã®è©³ç´°è¨­å®š

```json
{
    "openai_api_base": "http://localhost:11434/v1",
    "agent_model": "qwen3:14b",
    "log_folder": "logs",
    "report_folder": "out",
    "system_prompts": [
        "ã‚ãªãŸã¯MCPã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚",
        "MCP Toolã®çµæœã‚’å„ªå…ˆã—ã¦å›ç­”ã¨ã—ã¦æ¡ç”¨ã—ã¦ãã ã•ã„ã€‚",
        "é–‹å§‹æ™‚ã«ã¯ã€æ‹…å½“IDã¨é›»æŸ±IDã‚’å¿…ãšç¢ºèªã—ã¦ãã ã•ã„ã€‚",
        "ãƒã‚§ãƒƒã‚¯é …ç›®ã®OK/NGã®æ›´æ–°æŒ‡ç¤ºãŒã‚ã£ãŸå ´åˆã¯MCP Toolã‚’ä½¿ã£ã¦æ›´æ–°ã—ã¦ãã ã•ã„ã€‚",
        "å›ç­”ã¯è¡¨ã‚„æ®µçµ„ã¿ãªã©ã‚’ä½¿ã‚ãšã€èª­ã¿ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã‚‹çŸ­ã„æ—¥æœ¬èªã§æ›¸ã„ã¦ãã ã•ã„ã€‚"
    ],
    "color": {
        "tool": "32",     # MCPãƒ„ãƒ¼ãƒ«ï¼ˆç·‘ï¼‰
        "system": "36",   # ã‚·ã‚¹ãƒ†ãƒ ï¼ˆã‚·ã‚¢ãƒ³ï¼‰
        "agent": "93",    # AIå¿œç­”ï¼ˆæ˜ã‚‹ã„é»„ï¼‰
        "user": "91"      # ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆæ˜ã‚‹ã„èµ¤ï¼‰
    },
    "mcp_servers": {
        "checklist": {
            "transport": "stdio",
            "command": "java",
            "args": [
                "-Xms64m",
                "-Xmx128m",
                "-jar",
                "./sandbox-mcp-checklist-0.0.1-SNAPSHOT-all.jar",
                "--type", "3",
                "-c", "tcp://localhost:12345"
            ]
        }
    }
}
```

### é‡è¦ãªè¨­å®šé …ç›®

#### LLMãƒ¢ãƒ‡ãƒ«è¨­å®š
```json
{
    "openai_api_base": "http://localhost:11434/v1",  // Ollama API
    "agent_model": "qwen3:14b"                       // ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«
}
```

#### ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
æ¥­å‹™ç‰¹åŒ–ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ï¼š
```json
{
    "system_prompts": [
        "ã‚ãªãŸã¯MCPã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚",
        "é–‹å§‹æ™‚ã«ã¯ã€æ‹…å½“IDã¨é›»æŸ±IDã‚’å¿…ãšç¢ºèªã—ã¦ãã ã•ã„ã€‚",
        "ãƒã‚§ãƒƒã‚¯é …ç›®ã®OK/NGã®æ›´æ–°æŒ‡ç¤ºãŒã‚ã£ãŸå ´åˆã¯MCP Toolã‚’ä½¿ã£ã¦æ›´æ–°ã—ã¦ãã ã•ã„ã€‚"
    ]
}
```

#### MCPã‚µãƒ¼ãƒãƒ¼è¨­å®š
```json
{
    "mcp_servers": {
        "checklist": {                    // ã‚µãƒ¼ãƒãƒ¼è­˜åˆ¥å
            "transport": "stdio",         // é€šä¿¡æ–¹å¼
            "command": "java",            // å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
            "args": [                     // å¼•æ•°é…åˆ—
                "-jar", "./tool.jar",
                "--type", "3"
            ]
        }
    }
}
```

## ğŸ“¡ APIä»•æ§˜

### ãƒãƒ£ãƒƒãƒˆè£œå®Œã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```http
POST /v1/chat/completions
Content-Type: application/json

{
    "model": "qwen3:14b",
    "messages": [
        {
            "role": "user",
            "content": "æ‹…å½“ID 5ã€é›»æŸ± 789 ã§ãƒã‚§ãƒƒã‚¯é–‹å§‹"
        }
    ]
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹:**
```json
{
    "id": "chatcmpl-abc12345",
    "object": "chat.completion",
    "created": 1698765432,
    "model": "qwen3:14b",
    "choices": [
        {
            "index": 0,
            "message": {
                "role": "assistant",
                "content": "æ‹…å½“ID 5ã€é›»æŸ±ID 789ã§ãƒã‚§ãƒƒã‚¯ä½œæ¥­ã‚’é–‹å§‹ã—ã¾ã™ã€‚ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’æº–å‚™ã—ã¾ã—ãŸã€‚ã©ã®é …ç›®ã‹ã‚‰ç¢ºèªã—ã¾ã™ã‹ï¼Ÿ"
            },
            "finish_reason": "stop"
        }
    ],
    "usage": {
        "prompt_tokens": 45,
        "completion_tokens": 67,
        "total_tokens": 112
    }
}
```

### ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```http
GET /v1/models
```

```json
{
    "data": [
        {
            "id": "nautilus-llm",
            "object": "model"
        }
    ]
}
```

## ğŸ’¼ æ¥­å‹™ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### æ¨™æº–çš„ãªé›»æŸ±ãƒã‚§ãƒƒã‚¯æ‰‹é †

```mermaid
sequenceDiagram
    participant User as ä½œæ¥­è€…
    participant UI as OpenWebUI
    participant API as Denchu API
    participant MCP as MCPã‚µãƒ¼ãƒãƒ¼
    participant DB as ãƒã‚§ãƒƒã‚¯DB

    User->>UI: "æ‹…å½“ID 2ã€é›»æŸ±567ã§ãƒã‚§ãƒƒã‚¯é–‹å§‹"
    UI->>API: POST /v1/chat/completions
    API->>MCP: ãƒã‚§ãƒƒã‚¯é–‹å§‹è¦æ±‚
    MCP->>DB: ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ
    DB-->>MCP: ã‚»ãƒƒã‚·ãƒ§ãƒ³ID
    MCP-->>API: é–‹å§‹å®Œäº†
    API-->>UI: "ãƒã‚§ãƒƒã‚¯ä½œæ¥­ã‚’é–‹å§‹ã—ã¾ã—ãŸ"
    UI-->>User: AIå¿œç­”è¡¨ç¤º

    User->>UI: "é …ç›®1ã¯OK"
    UI->>API: POST /v1/chat/completions
    API->>MCP: é …ç›®1ã‚’OKè¨­å®š
    MCP->>DB: ãƒ‡ãƒ¼ã‚¿æ›´æ–°
    DB-->>MCP: æ›´æ–°å®Œäº†
    MCP-->>API: è¨˜éŒ²å®Œäº†
    API-->>UI: "é …ç›®1ã‚’OKã¨ã—ã¦è¨˜éŒ²ã—ã¾ã—ãŸ"

    User->>UI: "ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¦"
    UI->>API: POST /v1/chat/completions
    API->>MCP: ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆè¦æ±‚
    MCP->>DB: ãƒ‡ãƒ¼ã‚¿å–å¾—
    DB-->>MCP: ãƒã‚§ãƒƒã‚¯çµæœ
    MCP-->>API: Excelãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
    API-->>UI: "ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ"
```

### å®Ÿéš›ã®å¯¾è©±ä¾‹

```
ğŸ‘¤ ä½œæ¥­è€…: "æ‹…å½“ID 2ã€é›»æŸ±567ã§ãƒã‚§ãƒƒã‚¯é–‹å§‹"
ğŸ¤– AI: "æ‹…å½“ID 2ã€é›»æŸ±ID 567ã§ãƒã‚§ãƒƒã‚¯ä½œæ¥­ã‚’é–‹å§‹ã—ã¾ã™ã€‚ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’æº–å‚™ã—ã¾ã—ãŸã€‚"

ğŸ‘¤ ä½œæ¥­è€…: "1ç•ªã¯OK"
ğŸ¤– AI: "é …ç›®1ã‚’OKã¨ã—ã¦è¨˜éŒ²ã—ã¾ã—ãŸã€‚æ¬¡ã®é …ç›®ã‚’ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚"

ğŸ‘¤ ä½œæ¥­è€…: "2ç•ªã‚‚å•é¡Œãªã—"
ğŸ¤– AI: "é …ç›®2ã‚‚OKã¨ã—ã¦è¨˜éŒ²ã—ã¾ã—ãŸã€‚"

ğŸ‘¤ ä½œæ¥­è€…: "10ç•ªã¯å¤ããªã£ã¦ã‚‹ã®ã§NG"
ğŸ¤– AI: "é …ç›®10ã‚’NGã¨ã—ã¦è¨˜éŒ²ã—ã€å‚™è€ƒã«ã€Œå¤ã„ã€ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚ä¿®ç†ãŒå¿…è¦ã§ã™ã­ã€‚"

ğŸ‘¤ ä½œæ¥­è€…: "é€²æ—ç¢ºèª"
ğŸ¤– AI: "ç¾åœ¨ã®é€²æ—: å®Œäº† 3é …ç›®ã€OK 2é …ç›®ã€NG 1é …ç›®ã€‚æ®‹ã‚Šé …ç›®ã‚’ç¢ºèªã—ã¾ã™ã‹ï¼Ÿ"

ğŸ‘¤ ä½œæ¥­è€…: "ä»–ã¯å…¨éƒ¨OK"
ğŸ¤– AI: "æ®‹ã‚Šã®é …ç›®ã‚’ã™ã¹ã¦OKã¨ã—ã¦è¨˜éŒ²ã—ã¾ã—ãŸã€‚ãƒã‚§ãƒƒã‚¯ä½œæ¥­å®Œäº†ã§ã™ã€‚"

ğŸ‘¤ ä½œæ¥­è€…: "ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ"
ğŸ¤– AI: "ãƒã‚§ãƒƒã‚¯çµæœãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚ãƒ•ã‚¡ã‚¤ãƒ«å: checklist-result-20251027-1445.xlsx"
```

## ğŸ› ï¸ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### 1. æ¥­å‹™ç‰¹åŒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®èª¿æ•´

```json
{
    "system_prompts": [
        "ã‚ãªãŸã¯å»ºè¨­ç¾å ´ã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚",
        "å®‰å…¨ç¬¬ä¸€ã§ä½œæ¥­æŒ‡ç¤ºã‚’è¡Œã£ã¦ãã ã•ã„ã€‚",
        "ç•°å¸¸ã‚’ç™ºè¦‹ã—ãŸå ´åˆã¯å³åº§ã«å ±å‘Šã—ã¦ãã ã•ã„ã€‚"
    ]
}
```

### 2. ç‹¬è‡ªMCPã‚µãƒ¼ãƒãƒ¼ã®è¿½åŠ 

```json
{
    "mcp_servers": {
        "checklist": { /* æ—¢å­˜è¨­å®š */ },
        "maintenance": {
            "transport": "stdio",
            "command": "python",
            "args": ["maintenance_server.py"]
        },
        "notification": {
            "transport": "tcp",
            "host": "localhost",
            "port": 8081
        }
    }
}
```

### 3. ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‡¦ç†

```python
# app.pyå†…ã§è¿½åŠ 
async def custom_response_handler(result):
    """ã‚«ã‚¹ã‚¿ãƒ ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‡¦ç†"""
    if "ç·Šæ€¥" in result or "å±é™º" in result:
        # ç·Šæ€¥æ™‚ã®ç‰¹åˆ¥å‡¦ç†
        await send_emergency_notification(result)
    
    return result
```

## ğŸ“Š ç›£è¦–ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### ãƒ­ã‚°åˆ†æ

```python
# logs/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æ
import re
from collections import Counter

def analyze_logs():
    with open('logs/mcp_ex_text.20251027-1400.log') as f:
        logs = f.read()
    
    # ã‚¨ãƒ©ãƒ¼é »åº¦
    errors = re.findall(r'ERROR.*', logs)
    error_count = len(errors)
    
    # å‡¦ç†æ™‚é–“åˆ†æ
    times = re.findall(r'æ‰€è¦æ™‚é–“:(\d+:\d+:\d+)', logs)
    avg_time = calculate_average_time(times)
    
    return {
        'error_count': error_count,
        'average_time': avg_time
    }
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–

```bash
# ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ç›£è¦–
top -p $(pgrep -f "python app.py")

# APIå¿œç­”æ™‚é–“æ¸¬å®š
curl -w "@curl-format.txt" \
     -X POST "http://localhost:8000/v1/chat/completions" \
     -H "Content-Type: application/json" \
     -d '{"messages":[{"role":"user","content":"ãƒ†ã‚¹ãƒˆ"}]}'
```

## ğŸ”§ é–‹ç™ºè€…å‘ã‘æƒ…å ±

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

```python
# éåŒæœŸåˆæœŸåŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³
async def initialize_components():
    global agent, tools, llm
    
    # MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
    client = MultiServerMCPClient(mcp_config)
    tools = await client.get_tools()
    
    # ReActã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ§‹ç¯‰
    agent = create_react_agent(
        llm=llm,
        tools=tools,
        state_modifier=system_message,
        store=InMemoryStore()
    )
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

```python
@app.post("/v1/chat/completions")
async def chat_completions(request: Request):
    try:
        # ãƒ¡ã‚¤ãƒ³å‡¦ç†
        result = await agent.ainvoke({"input": prompt})
        return format_response(result)
    
    except MCPConnectionError:
        # MCPæ¥ç¶šã‚¨ãƒ©ãƒ¼æ™‚ã®ä»£æ›¿å‡¦ç†
        return fallback_response("MCPã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“")
    
    except Exception as e:
        # ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼
        log_error(e)
        return error_response(str(e))
```

### ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

```python
# tests/test_denchu.py
import pytest
from app import app

@pytest.mark.asyncio
async def test_chat_completion():
    """ãƒãƒ£ãƒƒãƒˆè£œå®ŒAPIã®ãƒ†ã‚¹ãƒˆ"""
    response = await client.post("/v1/chat/completions", json={
        "messages": [{"role": "user", "content": "ãƒ†ã‚¹ãƒˆ"}]
    })
    assert response.status_code == 200
    assert "content" in response.json()["choices"][0]["message"]

@pytest.mark.asyncio 
async def test_mcp_integration():
    """MCPçµ±åˆã®ãƒ†ã‚¹ãƒˆ"""
    # MCPã‚µãƒ¼ãƒãƒ¼ã¨ã®é€£æºãƒ†ã‚¹ãƒˆ
    pass
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. MCPã‚µãƒ¼ãƒãƒ¼æ¥ç¶šã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `MultiServerMCPClient connection failed`
**åŸå› **: JARãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸åœ¨ã€Javaç’°å¢ƒã®å•é¡Œ
**è§£æ±º**:
```bash
# Javaç’°å¢ƒç¢ºèª
java --version
echo $JAVA_HOME

# JARãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª
ls -la *.jar

# æ‰‹å‹•èµ·å‹•ãƒ†ã‚¹ãƒˆ
java -jar sandbox-mcp-checklist-0.0.1-SNAPSHOT-all.jar --help
```

#### 2. OpenWebUIé€£æºã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `Connection refused` ã¾ãŸã¯ `CORS error`
**åŸå› **: ãƒãƒ¼ãƒˆè¨­å®šã€CORSè¨­å®šã®å•é¡Œ
**è§£æ±º**:
```python
# app.py ã« CORSè¨­å®šè¿½åŠ 
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

#### 3. ãƒ¡ãƒ¢ãƒªä¸è¶³ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `OutOfMemoryError` ã¾ãŸã¯å¿œç­”é…å»¶
**åŸå› **: LLMãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã€ãƒ¡ãƒ¢ãƒªä¸è¶³
**è§£æ±º**:
```bash
# ã‚ˆã‚Šè»½é‡ãªãƒ¢ãƒ‡ãƒ«ã«å¤‰æ›´
ollama pull qwen3:8b  # 14b â†’ 8b

# Javaãƒ’ãƒ¼ãƒ—ã‚µã‚¤ã‚ºèª¿æ•´
"args": ["-Xms32m", "-Xmx64m", "-jar", "..."]
```

#### 4. ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶**: `'dict' object has no attribute 'find'`
**åŸå› **: OpenWebUIäº’æ›æ€§ã®å•é¡Œ
**è§£æ±º**: [ä¿®æ­£æ¸ˆã¿] é©åˆ‡ãªJSONå½¢å¼ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
denchu/
â”œâ”€â”€ app.py                              # ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒãƒ¼ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ app.json                            # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ logs/                              # ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â””â”€â”€ mcp_ex_text.YYYYMMDD-HHMM.log  # å®Ÿè¡Œãƒ­ã‚°
â””â”€â”€ README.md                          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«

å¤–éƒ¨ä¾å­˜:
â”œâ”€â”€ sandbox-mcp-checklist-*.jar        # MCPã‚µãƒ¼ãƒãƒ¼ï¼ˆJavaï¼‰
â””â”€â”€ out/                              # ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
```

## ğŸ”— é–¢é€£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ | ç”¨é€” | ç‰¹å¾´ |
|--------------|------|------|
| **[Simple](../simple/README.md)** | å­¦ç¿’ãƒ»ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ— | æœ€å°æ§‹æˆã€MCPç„¡ã— |
| **[Denchu Auto](../denchu_auto/README.md)** | è‡ªå‹•åŒ–ãƒ»ãƒãƒƒãƒ | UIç„¡ã—ã€äº‹å‰å®šç¾©å®Ÿè¡Œ |
| **[MCP Blend](../mcp_blend/README.md)** | MCPçµ±åˆã‚µãƒ³ãƒ—ãƒ« | è¤‡æ•°MCPã€å®Ÿé¨“çš„ |
| **[ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ](../../README.md)** | å…¨ä½“ç®¡ç† | ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å…¨ä½“ |

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ

| ãƒ¢ãƒ‡ãƒ« | åˆæœŸåŒ–æ™‚é–“ | å¿œç­”æ™‚é–“ | ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ | åŒæ™‚æ¥ç¶šæ•° |
|--------|-----------|----------|--------------|------------|
| qwen3:8b | 10-15ç§’ | 2-5ç§’ | 6GB | 5-10 |
| qwen3:14b | 15-25ç§’ | 3-8ç§’ | 10GB | 3-8 |
| qwen3:32b | 30-45ç§’ | 5-15ç§’ | 20GB | 1-3 |

### æ¨å¥¨ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

**é–‹ç™ºç’°å¢ƒ:**
- CPU: 4ã‚³ã‚¢ä»¥ä¸Š
- RAM: 16GBä»¥ä¸Š
- SSD: 50GBä»¥ä¸Š

**æœ¬ç•ªç’°å¢ƒ:**
- CPU: 8ã‚³ã‚¢ä»¥ä¸Š
- RAM: 32GBä»¥ä¸Š
- SSD: 100GBä»¥ä¸Š
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯: 1Gbpsä»¥ä¸Š

## ğŸš€ å°†æ¥ã®æ©Ÿèƒ½æ‹¡å¼µ

### çŸ­æœŸç›®æ¨™ï¼ˆ1-3ãƒ¶æœˆï¼‰
- [ ] éŸ³å£°å…¥åŠ›å¯¾å¿œï¼ˆWhisperçµ±åˆï¼‰
- [ ] ç”»åƒèªè­˜æ©Ÿèƒ½ï¼ˆé›»æŸ±å†™çœŸè§£æï¼‰
- [ ] ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªå¯¾å¿œ
- [ ] ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œãƒ¢ãƒ¼ãƒ‰

### ä¸­æœŸç›®æ¨™ï¼ˆ3-12ãƒ¶æœˆï¼‰
- [ ] ã‚¯ãƒ©ã‚¦ãƒ‰å±•é–‹ï¼ˆAWS/GCPï¼‰
- [ ] ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ
- [ ] é«˜å¯ç”¨æ€§æ§‹æˆ
- [ ] API Rate Limiting

### é•·æœŸç›®æ¨™ï¼ˆ1å¹´ä»¥ä¸Šï¼‰
- [ ] AI ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
- [ ] äºˆæ¸¬ä¿å…¨æ©Ÿèƒ½
- [ ] IoTã‚»ãƒ³ã‚µãƒ¼çµ±åˆ
- [ ] ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³è¨˜éŒ²

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ27æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0  
**ä½œæˆè€…**: SugioNakazawa